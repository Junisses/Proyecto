{% extends "index.html" %}
{% load static %}
{% load widget_tweaks %}
{% block contenido%}

	<form method="post" action="." enctype="multipart/form-data">
		<div class="card card-primary">
			<div class="card-header">
				<h3 class="card-title">
					<i class="fas fa-dog"></i>
					{{ title }}
				</h3>
			</div>
			<div class="card-body">
				<div class="form-group">
					<label>Regi√≥n:</label>
					{{ form.localidad }}
				</div>
				<div class="form-group">
					<label>Comuna:</label>
					{{ form.comunas }}
				</div>
			</div>
		</div>
	</form>
	
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<script>
	$(function() {
		$('select[nombre="localidad"]').on('change', function () {
			var id = $(this).val();
			var select_comunas = $('select[nombre="comuna"]');
			var options = '<option value="">--------</option>';
			if (id == ''){
				select_comunas.html(options);
				return false;
			$.ajax({
				url: window.location.pathname,
				type: 'POST',
				data: {
					'action': 'search_comuna_id',
					'id': id
				},
				dataType: 'json',
			}).done(function (data) {
				if (!data.hasOwnProperty('error')) {
					$.each(data, function (key, value) {
						options+='<option value="'+value.id+'">'+value.nombre+'</option>';
					return false;
			}
			).fail(function (jqXHR, textStatus, errorThrown) {
				alert(textStatus + ': ' + errorThrown);
			}).always(function (data) {
				select_comunas.html(options);
		});
	  }})
	}})});
	</script>

{% endblock %}